[[extend 'zlayout.html']]

[[block channel_header]]
<div class="row [[if not channel_info['banner']:]]zforum-header[[pass]] flex-shrink-0"
[[if channel_info['banner']:]]style="background-size:cover;background-repeat:no-repeat;background-image:url('[[=channel_info['banner']]]');"[[pass]]>
  <div class="col zforum-h-150">
    <h3><div class="m-2 p-2">/c/[[=channel_info['tag']]]</div></h3>
    <p>[[=XML(channel_info['title'])]]</p>
  </div>
</div>
[[end]]

[[if errors:]]
<div class="container pt-3">
  <div class="alert alert-warning" role="alert">
    <p>The following error(s) have been detected:</p>
    <ul>
      [[for error in errors:]]
        <li>[[=error]]</li>
      [[pass]]
    </ul>
  </div>
</div>
[[pass]]

[[=channel_info]]

<div class="container-fluid">
  <h4>Edit Channel Properties</h4>
  <hr>
  <form method="post" enctype="multipart/form-data" onsubmit="setFSize();" action="[[=URL('channel/admin/' + channel_info['id'])]]">
    <div class="row">
      <div class="col">
        <div class="mb-3">
          <label for="title" class="form-label">Channel Title:</label>
          <input type="text" class="form-control" id="title" aria-describedby="title-help"
            value="[[=request.forms.get('title', '')]]" name="title">
          <div id="title-help" class="form-text">Short title of your channel, usually
            consisting of a few sentences. This value is required.
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="mb-3">
          <label for="content" class="form-label">Channel Description:</label>
          <textarea class="form-control" id="content" rows="3" name="content"
            aria-describedby="desc-help">[[=request.forms.get('content', '')]]</textarea>
          <div id="desc-help" class="form-text">Blob, or a more detailed channel information
            in markdown format, html is allowed, but will be sanitized. 
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="mb-3">
          <label for="channel-img" class="form-label">Channel Banner:</label>
          <input class="form-control" type="file" id="channel-img" name="channel-img" aria-describedby="banner-help">
          <div id="banner-help" class="form-text">Optional Banner, it will use top-left
            part of the uploaded image, and 150px height, large images may be declined. This 
            value is optional.
          </div>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="remove-banner"
            name="remove-banner">
          <label class="form-check-label" for="remove-banner">
            Remove Banner (if previously set, using the system's default)
          </label>
        </div>
      </div>
    </div>
    <div class="row">
      <div class="col">
        <div class="form-check">
          <input class="form-check-input" type="checkbox" id="is-public"
            name="is-public"
            [[if request.forms.get('is-public', '') or request.method == 'GET':]]checked[[pass]]>
          <label class="form-check-label" for="is-public">
            This channel is Public
          </label>
        </div>
      </div>
    </div>

    <input type="hidden" id="fSize" name="fSize" value="0">

    <div class="my-3">
      <button type="submit" class="btn btn-primary" id="update-button" name="update-button">Update Channel</button>
      <button type="submit" class="btn btn-primary" id="cancel-button" name="cancel-button">Cancel</button>
    </div>
  </form>
</div>


[[block page_scripts]]
<script>
  let setFSize = () => {
    let fSize = 0;
    let fileInput = document.getElementById('channel-img');
    if (fileInput.files.length > 0) {
      fSize = fileInput.files[0].size;
    }
    document.getElementById('fSize').value = fSize.toString();
    return true;
  }
</script>

[[end]]